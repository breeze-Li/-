C51 COMPILER V9.59.0.0   DS18B20                                                           07/01/2023 20:51:03 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE DS18B20
OBJECT MODULE PLACED IN ds18b20.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ds18b20.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /******************************************************************
   2          ʱDS18B20м⣬DS18B20ⲻرʾ
   3          λʾ¶ȣλΪ0أΧ-55+128
   4          KEY3лģʽ,LED3ָʾ״̬(ڹ,򲻹,ģʽƱʾ,ģʽ±ʾ
             -..)
   5          ******************************************************************/
   6          #include <reg51.h>
   7          #include <intrins.h>
   8          #include "ds18b20.h"
   9          
  10          sbit LED1=P1^0;  //ģʽָʾ
  11          sbit LED2=P1^1;  //ģʽָʾ
  12          sbit LED3=P1^2;  //¶δﵽ趨¶ȣ/乤ָʾ
  13          sbit KEY1=P1^4;  //¶
  14          sbit KEY2=P1^5;  //¶ȼ
  15          sbit KEY3=P1^6;  ///ģʽл
  16          sbit COD1=P3^6;  //
  17          sbit HOT1=P3^7;  //ȿ  
  18          
  19          //  ActualTemperatureʾʵ¶ȣShowTemperatureʾ¶ȣ modeָʾģʽ״̬ 0: COD 1: HOT   TargetTe
             -mperatureΪ趨¶ֵ
  20          int ShowTemperature, mode, TargetTemperature; 
  21          unsigned char b1,b2,b3; //
  22          TargetTemperature = 24; //¶24
  23          
  24          void main(void)
  25          {   
  26   1        while(1)
  27   1        {   Read_Temperature();
  28   2          if(flash==0)             
  29   2             Disp_Temperature();
  30   2          else
  31   2             P2 =0xff ;        //DS18B20رʾ ,1ʾ
  32   2      
  33   2      
  34   2        if(!KEY1) b1++;
  35   2          if((KEY1==1)&&(b1>0)) {TargetTemperature = (TargetTemperature+1); b1=0;}  //¶
  36   2        if(b1>100) TargetTemperature = (TargetTemperature+1);  //һֱסԶѭ
  37   2      
  38   2        if(!KEY2) b2++;
  39   2          if((KEY2==1)&&(b2>0)) {TargetTemperature = (TargetTemperature-1);b2=0;} //¶ȼ
  40   2        if(b2>100) TargetTemperature = (TargetTemperature-1);  //һֱסԶѭ
  41   2      
  42   2        //mode=0:ʵActualTemperature趨TargetTemperature   LED3=0
  43   2        if( ActualTemperature > TargetTemperature) LED3=0;else LED3=1;    
  44   2        //mode=1:ΪģʽĹ״̬ȡ(Ҫ/,Ҫ/)  Ǽģʽ
             -,ٰLED3. ڶϵ1ж
  45   2        if( mode == 1 ) {LED3=(!LED3);}    //аģʽ * ¶ = 4 ,ܽǷҪ,
             -LED3ָʾ.
  46   2      
  47   2        if(!KEY3) b3++;
  48   2          if((KEY3==1)&&(b3>0)) {mode=(mode+1);b3=0;} ///л
  49   2      
  50   2        //ģʽLED
  51   2        if(mode==0) {LED1=0;LED2=1;}     //ָʾƿ
C51 COMPILER V9.59.0.0   DS18B20                                                           07/01/2023 20:51:03 PAGE 2   

  52   2        if(mode==1) {LED1=1;LED2=0;}     //ָʾƿ ϵ1
  53   2        
  54   2        if(mode>=2) mode=0;     //ģʽл mode %= 2;
  55   2        //LED3==0ʾҪ,LED1LED2ģʽ
  56   2        if((LED1==0)&&(LED3==0)) COD1=0;else COD1=1; //俪
  57   2        if((LED2==0)&&(LED3==0)) HOT1=0;else HOT1=1; //ȿ
  58   2      
  59   2        //¶޷
  60   2        if(TargetTemperature>1280) TargetTemperature=1280; //趨¶
  61   2        if(TargetTemperature<-550) TargetTemperature=-550; //趨¶
  62   2      
  63   2        //TargetTemperatureС0 ShowTemperatureTargetTemperatureĲ0X01
  64   2        if(TargetTemperature<0) ShowTemperature =~ TargetTemperature+0x01; else ShowTemperature=TargetTemperature
             -;  
  65   2      
  66   2          display[7]=ShowTemperature/1000;    //¶ȵİλ
  67   2          display[6]=ShowTemperature%1000/100;//¶ֵʮλ 
  68   2          display[5]=ShowTemperature%100/10;  //¶ֵĸλ
  69   2          display[4]=ShowTemperature%10;      //¶ֵСһλ
  70   2          if(!display[7]){                    //λΪ0ʾ
  71   3              display[7]=0x0a;              
  72   3              if(!display[6])                 //θλΪ0ʾ
  73   3                display[6]=0x0a;
  74   3          }
  75   2          if(TargetTemperature < 0){        //TargetTemperatureС0Ϊ
  76   3            if(display[6]==0x0a)            //¶ȵʮλΪ0
  77   3              display[6]=0x0b;              //ʮλʾ
  78   3          else
  79   3          display[7]=0x0b;                  //¶ȵİλʾ
  80   3          } 
  81   2        }
  82   1      }
  83          
*** WARNING C290 IN LINE 70 OF ds18b20.c: missing return value
*** WARNING C290 IN LINE 102 OF ds18b20.c: missing return value
*** WARNING C290 IN LINE 137 OF ds18b20.c: missing return value


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    971    ----
   CONSTANT SIZE    =     28    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     31    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  3 WARNING(S),  0 ERROR(S)
